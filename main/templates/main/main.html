{% extends "wrapper.html" %}

{% load staticfiles %}


{% block title %}
    <title>Digit Edu | Главная</title>
{% endblock %}

{% block style %}
    <link rel="stylesheet" href="{% static 'main/mainPage/css/style.css' %}"/>
    <link href="http://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <link href="{% static 'main/mainPage/css/timer/base.css' %}" rel="stylesheet"/>
{% endblock %}

{% block navigation %}
    {% include 'includes/header.html' %}
{% endblock %}


{% block content %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ajaxtransport-xdomainrequest/1.0.4/jquery.xdomainrequest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
    <script src="{% static 'main/mainPage/js/timer/digital-countdown.js' %}"></script>
    <script src="{% static 'main/mainPage/js/lessonsGraph.js' %}"></script>

    <main>
        <div class="blocks">
            <div class="wrapper">
                {% if user.is_authenticated %}
                    <div class="main__timeline block">
                        <div class="top">
                            <p class="title">Прослушано пар</p>
                        </div>
                        <div class="bottom">
                            <div class="left">
                                <canvas id="lessonsGraph" alt=""></canvas>
                                <script type="application/javascript">drawStudentLessonsGraph({{ user.student.pk }})</script>
                            </div>
                            <div class="right">
                                <ul class="subjects">
                                    {% for lesson in user.student.group.subject_sorted_lesson_set.all %}
                                        <li class="subject">{{ lesson.subject.name }}</li>
                                    {% endfor %}
                                    {% comment %}<li class="subject">Мат. анализ</li>
                                <li class="subject">Геометрия</li>
                                <li class="subject">Дискр. математика</li>
                                <li class="subject">Информатика</li>
                                <li class="subject">АИСД</li>
                                <li class="subject">Английский</li>
                                <li class="subject">Русский</li>{% endcomment %}
                                </ul>
                                <ul class="counts">
                                    {% for lesson in user.student.group.subject_sorted_lesson_set.all %}
                                        <li class="count">{{ lesson.passed }} из {{ lesson.total }}</li>
                                    {% endfor %}
                                    {% comment %}<li class="count">63 из 72</li>
                                <li class="count">63 из 72</li>
                                <li class="count">63 из 72</li>
                                <li class="count">78 из 90</li>
                                <li class="count">63 из 72</li>
                                <li class="count">63 из 72</li>
                                <li class="count">30 из 36</li>{% endcomment %}
                                </ul>
                            </div>
                        </div>
                    </div>
                {% endif %}


                <div class="main__timer block">
                    <div class="title">До первого экзамена</div>
                    <div class="timer">
                        <div id="this_clock" class="clock"></div>
                    </div>
                </div>

                <a data-toggle="modal"
                        {% if user.is_authenticated %}
                   onclick="location.href='/cabinet';"
                        {% else %}
                   href="#exampleModal"
                        {% endif %}>
                    <div class="main__profile block">
                        <div class="content">
                            <div class="title">Личный кабинет</div>
                            <div class="subtitle">Анализ успеваемости и другая полезная информация в вашем профиле</div>
                        </div>
                    </div>
                </a>

                <div class="main__ratings block">
                    <div class="content">
                        <div class="title">Рейтинги</div>
                        <div class="subtitle">Рейтинг студентов по результатам последней сессии</div>
                    </div>
                </div>

                <div class="main__services block">
                    <div class="content">
                        <div class="title">Сервисы</div>
                        <div class="subtitle">Наиболее используемые сервисы для подготовки / развития / времяпровождения
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    {% include 'includes/loginModal.html' %}

    <script type="application/javascript">$("#this_clock").countdownDigital({
        dateTo: '{{ session.date|date:"c" }}'
    });</script>
{% endblock %}

<div class="mainContent">
    <h1>Главная</h1>

    <h3>Какая-то инфографика</h3>
    <h4>Сессия начнется {{ session.date }}</h4>
    <h4>Время: {{ time }}</h4>
    <h4>До начала сессии: {{ timediff }}</h4>
</div>
